stage('Smoke Test') {
  steps {
    echo '🩺 Smoke test: cek /healthz'
    sleep time: 5, unit: 'SECONDS'                  // beri waktu container start
    retry(3) {                                      // coba 3x, jeda 3 detik
      sleep time: 3, unit: 'SECONDS'
      bat 'curl -sSf http://localhost:8080/healthz >NUL'  // sukses jika HTTP 200
    }
  }
  post {
    failure {
      echo '❌ Smoke test gagal, tampilkan log:'
      bat 'docker ps'
      bat 'docker logs apps_go_cloud --tail=200 || ver >NUL'
    }
  }
}
